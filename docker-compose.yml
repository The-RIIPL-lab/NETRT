services:
  correct:
    build:
      context: .
      args:
        - UID=${UID:-1000}
        - GID=${GID:-1000}
    container_name: correct
    restart: unless-stopped
    ports:
      # Maps the host port (left) to the container port (right) for the DICOM listener.
      # Ensure the right-side port matches the 'port' in your config.yaml.
      - "11112:11112"
    command: python main.py --config /app/config/config.yaml --debug
    environment:
      - WATCHDOG_USE_POLLING=false
    volumes:
      # Mounts the local config.yaml file as read-only into the container.
      # The container's CMD is set to look for the config at this path.
      - ~/NETRT/config.yaml:/app/config/config.yaml:ro

      # Mounts a local directory for the application's working data.
      # This path should correspond to the 'directories.working' path in your config.yaml,
      # but pointing to the path *inside* the container (e.g., /home/appuser/CORRECT_working).
      - ~/NETRT/data/working:/home/appuser/CORRECT_working:rw,z

      # Mounts a local directory for persistent log files.
      # This path should correspond to the 'directories.logs' path in your config.yaml,
      - ~/NETRT/data/logs:/home/appuser/CORRECT_logs:rw,z
      
      # Mounts a local directory for the output data.
      - ~/NETRT/data/output:/mnt/shared

networks:
  default:
    driver: bridge